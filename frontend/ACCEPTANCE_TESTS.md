# Post Creator - 验收测试清单

## 功能测试

### 基本功能

- [ ] **F1.1**: 页面加载后显示 "Create Post" 标签页
- [ ] **F1.2**: 点击 "Messaging" 标签切换到消息界面
- [ ] **F1.3**: 点击 "Create Post" 标签切换回 Post 创建界面
- [ ] **F1.4**: Caption 输入框可以输入文字
- [ ] **F1.5**: Caption 字符计数正确显示（0-2200）

### 照片上传

- [ ] **P1.1**: 点击 "📷 Add Photos" 打开文件选择对话框
- [ ] **P1.2**: 选择 JPEG 文件成功添加到预览
- [ ] **P1.3**: 选择 PNG 文件成功添加到预览
- [ ] **P1.4**: 选择 WebP 文件成功添加到预览
- [ ] **P1.5**: 选择 HEIC 文件成功添加到预览
- [ ] **P1.6**: 选择多个照片文件一次性添加
- [ ] **P1.7**: 照片预览正确显示缩略图
- [ ] **P1.8**: 照片文件名和大小正确显示
- [ ] **P1.9**: 点击照片上的 "×" 按钮删除该照片
- [ ] **P1.10**: 删除照片后预览更新正确

### 视频上传

- [ ] **V1.1**: 点击 "🎥 Add Videos" 打开文件选择对话框
- [ ] **V1.2**: 选择 MP4 文件成功添加到预览
- [ ] **V1.3**: 选择 QuickTime 文件成功添加到预览
- [ ] **V1.4**: 选择 WebM 文件成功添加到预览
- [ ] **V1.5**: 选择多个视频文件一次性添加
- [ ] **V1.6**: 视频预览显示播放控件
- [ ] **V1.7**: 视频预览可以播放
- [ ] **V1.8**: 视频文件名和大小正确显示
- [ ] **V1.9**: 点击视频上的 "×" 按钮删除该视频
- [ ] **V1.10**: 删除视频后预览更新正确

### 文件验证

- [ ] **V2.1**: 照片小于 100KB 显示错误消息
- [ ] **V2.2**: 照片大于 50MB 显示错误消息
- [ ] **V2.3**: 视频大于 500MB 显示错误消息
- [ ] **V2.4**: 不支持的照片格式（如 GIF）显示错误消息
- [ ] **V2.5**: 不支持的视频格式（如 AVI）显示错误消息
- [ ] **V2.6**: PDF 文件被拒绝
- [ ] **V2.7**: 错误消息清晰易懂

### 上传流程

- [ ] **U1.1**: 没有选择文件时，"Create Post" 按钮禁用
- [ ] **U1.2**: 选择文件后，"Create Post" 按钮启用
- [ ] **U1.3**: 点击 "Create Post" 显示上传进度
- [ ] **U1.4**: 上传进度条实时更新（0-100%）
- [ ] **U1.5**: 每个文件都显示独立的进度条
- [ ] **U1.6**: 上传成功显示 "✓ Done"
- [ ] **U1.7**: 上传失败显示 "✗ Failed" 和错误消息
- [ ] **U1.8**: 成功后弹出提示（包含 Post ID）
- [ ] **U1.9**: 成功后清空表单和预览
- [ ] **U1.10**: 上传中按钮显示 "Uploading..."
- [ ] **U1.11**: 上传中所有输入禁用
- [ ] **U1.12**: 可以同时上传照片和视频

### 响应式设计

- [ ] **R1.1**: 桌面端（>768px）布局正确
- [ ] **R1.2**: 移动端（<768px）布局正确
- [ ] **R1.3**: 预览网格自适应屏幕宽度
- [ ] **R1.4**: 按钮在移动端全宽显示
- [ ] **R1.5**: 所有文字可读（无截断）

### 可访问性

- [ ] **A1.1**: Tab 键可以导航到所有交互元素
- [ ] **A1.2**: Enter 键可以触发按钮点击
- [ ] **A1.3**: 所有按钮有明确的 aria-label
- [ ] **A1.4**: 错误消息使用 role="alert"
- [ ] **A1.5**: Focus 状态清晰可见
- [ ] **A1.6**: 屏幕阅读器可以读取所有内容

## 集成测试

### API 集成

- [ ] **I1.1**: POST /api/v1/posts/upload/init 调用成功
- [ ] **I1.2**: 预签名 URL 可以上传到 S3
- [ ] **I1.3**: POST /api/v1/posts/upload/complete 调用成功
- [ ] **I1.4**: POST /api/v1/videos/upload-url 调用成功
- [ ] **I1.5**: POST /api/v1/videos 调用成功
- [ ] **I1.6**: JWT token 正确包含在请求头
- [ ] **I1.7**: 401 错误正确处理
- [ ] **I1.8**: 网络错误正确处理
- [ ] **I1.9**: 超时错误正确处理

### 错误场景

- [ ] **E1.1**: 后端服务不可用时显示友好错误
- [ ] **E1.2**: Token 过期时提示重新登录
- [ ] **E1.3**: S3 上传失败时显示错误
- [ ] **E1.4**: 文件哈希验证失败时显示错误
- [ ] **E1.5**: 网络中断时显示错误

## 性能测试

- [ ] **P2.1**: 页面加载时间 < 2 秒
- [ ] **P2.2**: 文件验证响应时间 < 50ms
- [ ] **P2.3**: 预览生成时间 < 200ms/文件
- [ ] **P2.4**: 10MB 照片上传完成时间 < 10 秒
- [ ] **P2.5**: 100MB 视频上传完成时间 < 60 秒
- [ ] **P2.6**: 并行上传 5 个文件不卡顿
- [ ] **P2.7**: 内存使用合理（无泄漏）

## 浏览器兼容性

### Chrome
- [ ] **B1.1**: Chrome 最新版本功能正常
- [ ] **B1.2**: 文件选择正常
- [ ] **B1.3**: 预览显示正常
- [ ] **B1.4**: 上传成功

### Firefox
- [ ] **B2.1**: Firefox 最新版本功能正常
- [ ] **B2.2**: 文件选择正常
- [ ] **B2.3**: 预览显示正常
- [ ] **B2.4**: 上传成功

### Safari
- [ ] **B3.1**: Safari 最新版本功能正常
- [ ] **B3.2**: HEIC 文件支持正常
- [ ] **B3.3**: 预览显示正常
- [ ] **B3.4**: 上传成功

### Edge
- [ ] **B4.1**: Edge 最新版本功能正常
- [ ] **B4.2**: 文件选择正常
- [ ] **B4.3**: 预览显示正常
- [ ] **B4.4**: 上传成功

### 移动浏览器
- [ ] **B5.1**: iOS Safari 功能正常
- [ ] **B5.2**: Android Chrome 功能正常
- [ ] **B5.3**: 相机拍照上传支持
- [ ] **B5.4**: 触摸交互流畅

## 安全测试

- [ ] **S1.1**: XSS 攻击防护（文件名、Caption）
- [ ] **S1.2**: 文件类型验证不可绕过
- [ ] **S1.3**: 文件大小验证不可绕过
- [ ] **S1.4**: Token 不在控制台日志泄漏
- [ ] **S1.5**: 预签名 URL 限时有效

## 回归测试

- [ ] **R2.1**: Messaging 功能仍然正常工作
- [ ] **R2.2**: 原有组件未受影响
- [ ] **R2.3**: 构建成功无警告
- [ ] **R2.4**: 测试全部通过

## 测试数据

### 测试文件准备

```bash
# 照片
- small.jpg (50KB) - 应该失败
- valid.jpg (2MB) - 应该成功
- large.jpg (60MB) - 应该失败
- photo.png (1MB) - 应该成功
- photo.webp (1MB) - 应该成功
- photo.heic (1MB) - 应该成功
- document.pdf (1MB) - 应该失败

# 视频
- valid.mp4 (50MB) - 应该成功
- large.mp4 (600MB) - 应该失败
- video.mov (50MB) - 应该成功
- video.webm (50MB) - 应该成功
- video.avi (50MB) - 应该失败
```

## 测试环境

- **OS**: macOS, Windows, Linux
- **Node**: v18+
- **浏览器**: 最新版本的 Chrome, Firefox, Safari, Edge
- **网络**: 正常网速 (10Mbps+)
- **后端**: user-service 运行在 localhost:8080

## 验收标准

通过条件：
- ✅ 所有功能测试通过率 > 95%
- ✅ 所有集成测试通过
- ✅ 至少 3 个主流浏览器测试通过
- ✅ 移动端测试通过
- ✅ 性能测试达标
- ✅ 无阻塞性 bug

## 测试执行

```bash
# 1. 启动后端
cd backend/user-service
cargo run

# 2. 启动前端
cd frontend
npm run dev

# 3. 打开浏览器
open http://localhost:5173

# 4. 执行测试清单
# 逐项勾选测试结果

# 5. 记录 bug
# 在 GitHub Issues 中创建 bug 报告
```

## Bug 报告模板

```markdown
### Bug 描述
[清晰描述问题]

### 复现步骤
1. [步骤 1]
2. [步骤 2]
3. [步骤 3]

### 期望结果
[应该发生什么]

### 实际结果
[实际发生了什么]

### 环境
- 浏览器: [Chrome 120]
- OS: [macOS 14]
- 前端版本: [commit hash]

### 截图
[如果适用]
```

## 测试报告

完成测试后，填写以下报告：

```
测试日期: [YYYY-MM-DD]
测试人员: [姓名]
测试环境: [详细信息]

通过测试: [X/总数]
失败测试: [Y/总数]
阻塞 Bug: [数量]
非阻塞 Bug: [数量]

总体评价: [通过/失败/需改进]

详细报告: [链接或附件]
```
