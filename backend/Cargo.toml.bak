[workspace]
members = [
    "auth-service",
    "user-service",
    "content-service",
    "media-service",
    "messaging-service",
    "search-service",
    "recommendation-service",
    "video-service",
    "streaming-service",
    "notification-service",
    "cdn-service",
    "events-service",
    "libs/crypto-core",
    "libs/error-types",
    "libs/redis-utils",
    "libs/db-pool",
    "libs/error-handling",
    "libs/video-core",
    "libs/nova-fcm-shared",
    "libs/nova-apns-shared",
    "libs/event-schema"
]
resolver = "2"

[workspace.package]
version = "0.1.0"
edition = "2021"
authors = ["Nova Team <team@nova.dev>"]
license = "MIT"
rust-version = "1.75"

[workspace.dependencies]
# Web framework
actix-web = "4.5"
actix-rt = "2.9"
actix-cors = "0.7"

# Async runtime
tokio = { version = "1.36", features = ["full"] }

# Database
sqlx = { version = "0.7", features = ["runtime-tokio-rustls", "postgres", "uuid", "chrono", "migrate"] }

# Redis
redis = { version = "0.25", features = ["tokio-comp", "connection-manager", "streams", "sentinel"] }

# Serialization
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"

# Utilities
uuid = { version = "1.7", features = ["v4", "serde"] }
chrono = { version = "0.4", features = ["serde"] }
dotenv = "0.15"
envy = "0.4"
once_cell = "1.19"
hkdf = "0.12"

# Logging
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter"] }
tracing-actix-web = "0.7"

# Error handling
thiserror = "1.0"
anyhow = "1.0"

# Security
argon2 = "0.5"
jsonwebtoken = "9.2"
rand = "0.8"
rsa = { version = "0.9", features = ["sha2"] }
aes-gcm = "0.10"
hmac = "0.12"
qrcode = "0.12"

# Validation
validator = { version = "0.18", features = ["derive"] }

# Email
lettre = { version = "0.11", default-features = false, features = ["tokio1-rustls-tls", "smtp-transport", "builder", "hostname"] }

# Rate limiting
governor = "0.6"

# Metrics (optional)
prometheus = { version = "0.13", features = ["process"] }

# AWS SDK
aws-config = "1.1"
aws-sdk-s3 = "1.13"

# Hashing and encoding
sha1 = "0.10"
sha2 = "0.10"
hex = "0.4"

# MIME type detection
mime = "0.3"

# Encoding
base64 = "0.22"

# Async traits
async-trait = "0.1"

# Streaming-specific dependencies
futures = "0.3"
bytes = "1.5"
nom = "7.1"
rmp-serde = "1.1"
avro-rs = "0.13"
ffmpeg-sidecar = "1.1"
actix-ws = "0.2"

# HTTP client for OAuth
reqwest = { version = "0.12", features = ["json"] }
urlencoding = "2.1"

# ClickHouse client
clickhouse = { version = "0.12" }
rdkafka = { version = "0.36", features = ["tokio", "cmake-build"] }

# gRPC
tonic = { version = "0.11", features = ["transport"] }
prost = "0.12"

# Swagger/OpenAPI
# utoipa 用於生成 OpenAPI 3.0 規範
# Swagger UI 通過 Nginx 靜態服務，不依賴框架
utoipa = { version = "4.0", features = ["uuid", "chrono"] }

[profile.release]
opt-level = 3
lto = true
codegen-units = 1
strip = true
panic = "abort"

[profile.dev]
opt-level = 0
debug = true
