syntax = "proto3";
package nova.social_service.v2;

import "google/protobuf/timestamp.proto";
import "google/protobuf/empty.proto";

// Social Service - Relationships & Engagement
service SocialService {
  // Relationships
  rpc FollowUser(FollowUserRequest) returns (google.protobuf.Empty);
  rpc UnfollowUser(UnfollowUserRequest) returns (google.protobuf.Empty);
  rpc BlockUser(BlockUserRequest) returns (google.protobuf.Empty);
  rpc UnblockUser(UnblockUserRequest) returns (google.protobuf.Empty);
  rpc GetFollowers(GetFollowersRequest) returns (GetFollowersResponse);
  rpc GetFollowing(GetFollowingRequest) returns (GetFollowingResponse);
  rpc GetRelationship(GetRelationshipRequest) returns (GetRelationshipResponse);

  // Likes
  rpc CreateLike(CreateLikeRequest) returns (CreateLikeResponse);
  rpc DeleteLike(DeleteLikeRequest) returns (DeleteLikeResponse);
  rpc GetLikes(GetLikesRequest) returns (GetLikesResponse);
  rpc CheckUserLiked(CheckUserLikedRequest) returns (CheckUserLikedResponse);

  // Comments
  rpc CreateComment(CreateCommentRequest) returns (CreateCommentResponse);
  rpc DeleteComment(DeleteCommentRequest) returns (DeleteCommentResponse);
  rpc GetComments(GetCommentsRequest) returns (GetCommentsResponse);

  // Shares
  rpc CreateShare(CreateShareRequest) returns (CreateShareResponse);
  rpc GetShareCount(GetShareCountRequest) returns (GetShareCountResponse);

  // Feed
  rpc GetUserFeed(GetUserFeedRequest) returns (GetUserFeedResponse);
  rpc GetExploreFeed(GetExploreFeedRequest) returns (GetExploreFeedResponse);
}

// Relationships
message FollowUserRequest { string follower_id = 1; string followee_id = 2; }
message UnfollowUserRequest { string follower_id = 1; string followee_id = 2; }
message BlockUserRequest { string blocker_id = 1; string blockee_id = 2; }
message UnblockUserRequest { string blocker_id = 1; string blockee_id = 2; }
message GetFollowersRequest { string user_id = 1; int32 limit = 2; int32 offset = 3; }
message GetFollowersResponse { repeated string user_ids = 1; int32 total = 2; }
message GetFollowingRequest { string user_id = 1; int32 limit = 2; int32 offset = 3; }
message GetFollowingResponse { repeated string user_ids = 1; int32 total = 2; }
message GetRelationshipRequest { string user_id = 1; string other_user_id = 2; }
message GetRelationshipResponse { Relationship relationship = 1; }

// Likes
message CreateLikeRequest { string user_id = 1; string post_id = 2; }
message CreateLikeResponse { bool success = 1; int64 like_count = 2; }
message DeleteLikeRequest { string user_id = 1; string post_id = 2; }
message DeleteLikeResponse { bool success = 1; int64 like_count = 2; }
message GetLikesRequest { string post_id = 1; int32 limit = 2; int32 offset = 3; }
message GetLikesResponse { repeated Like likes = 1; int32 total = 2; }
message CheckUserLikedRequest { string user_id = 1; string post_id = 2; }
message CheckUserLikedResponse { bool liked = 1; }

// Comments
message CreateCommentRequest {
  string user_id = 1;
  string post_id = 2;
  string content = 3;
  string parent_comment_id = 4;
}
message CreateCommentResponse { Comment comment = 1; }
message DeleteCommentRequest { string user_id = 1; string comment_id = 2; }
message DeleteCommentResponse { bool success = 1; }
message GetCommentsRequest { string post_id = 1; int32 limit = 2; int32 offset = 3; }
message GetCommentsResponse { repeated Comment comments = 1; int32 total = 2; }

// Shares
message CreateShareRequest {
  string user_id = 1;
  string post_id = 2;
  string caption = 3;
}
message CreateShareResponse { bool success = 1; }
message GetShareCountRequest { string post_id = 1; }
message GetShareCountResponse { int64 count = 1; }

// Feed
message GetUserFeedRequest { string user_id = 1; int32 limit = 2; string cursor = 3; }
message GetUserFeedResponse { repeated FeedItem items = 1; string next_cursor = 2; bool has_more = 3; }
message GetExploreFeedRequest { int32 limit = 1; string cursor = 2; }
message GetExploreFeedResponse { repeated FeedItem items = 1; string next_cursor = 2; bool has_more = 3; }

// Models
message Relationship {
  string id = 1;
  string follower_id = 2;
  string followee_id = 3;
  RelationshipType type = 4;
  RelationshipStatus status = 5;
  google.protobuf.Timestamp created_at = 6;
  google.protobuf.Timestamp updated_at = 7;
}

enum RelationshipType {
  RELATIONSHIP_TYPE_UNSPECIFIED = 0;
  RELATIONSHIP_TYPE_FOLLOW = 1;
  RELATIONSHIP_TYPE_BLOCK = 2;
  RELATIONSHIP_TYPE_MUTE = 3;
}

enum RelationshipStatus {
  RELATIONSHIP_STATUS_UNSPECIFIED = 0;
  RELATIONSHIP_STATUS_ACTIVE = 1;
  RELATIONSHIP_STATUS_PENDING = 2;
  RELATIONSHIP_STATUS_REJECTED = 3;
}

message Like {
  string id = 1;
  string user_id = 2;
  string post_id = 3;
  google.protobuf.Timestamp created_at = 4;
}

message Comment {
  string id = 1;
  string user_id = 2;
  string post_id = 3;
  string content = 4;
  string parent_comment_id = 5;
  google.protobuf.Timestamp created_at = 6;
}

message FeedItem {
  string id = 1;
  string content_id = 2;
  string author_id = 3;
  double relevance_score = 4;
  google.protobuf.Timestamp created_at = 5;
}
