apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

bases:
- ../../base

namespace: nova

# 开发环境特定配置
patchesStrategicMerge:
- deployment-patch.yaml
- replicas-patch.yaml

# 环境变量覆盖
configMapGenerator:
- name: nova-config
  behavior: merge
  literals:
  - APP_ENV=development
  - LOG_LEVEL=debug
  - RUST_LOG=debug,actix_web=debug

# 镜像配置（用于本地开发，可能需要 imagePullPolicy: Never）
images:
- name: nova/content-service
  newTag: dev-latest
  newName: nova/content-service
- name: nova/media-service
  newTag: dev-latest
  newName: nova/media-service
- name: nova/user-service
  newTag: dev-latest
  newName: nova/user-service
- name: nova/messaging-service
  newTag: dev-latest
  newName: nova/messaging-service

# 副本数（开发环境可以只用1个）
replicas:
- name: content-service
  count: 1
- name: media-service
  count: 1
- name: user-service
  count: 1
- name: messaging-service
  count: 1

commonAnnotations:
  environment: development
  deployment.kubernetes.io/revision: "1"
