apiVersion: v1
kind: ConfigMap
metadata:
  name: realtime-chat-service-config
data:
  LOG_LEVEL: "info"
  ENVIRONMENT: "staging"
  # Server
  PORT: "8080"
  GRPC_PORT: "9095"
  # Redis
  REDIS_URL: "redis://redis-master.nova-staging.svc.cluster.local:6379"
  # gRPC services
  # Identity service uses mTLS in staging
  GRPC_IDENTITY_SERVICE_URL: "https://identity-service.nova-staging.svc.cluster.local:50051"
  # Social service (Tier0 - required for DM permission checks)
  GRPC_SOCIAL_SERVICE_URL: "https://social-service.nova-staging.svc.cluster.local:50052"
  # Ranking service - downgrade to Tier1 (not critical for chat)
  GRPC_RANKING_SERVICE_TIER: "tier1"
  # S3
  S3_BUCKET: "nova-media-staging"
  S3_REGION: "ap-northeast-1"
  # WebRTC ICE
  ICE_TTL_SECONDS: "86400"
  RTC_STUN_URLS: "stun:stun.l.google.com:19302,stun:stun1.l.google.com:19302"
  # Matrix E2EE Integration
  MATRIX_ENABLED: "true"
  MATRIX_HOMESERVER_URL: "http://matrix-synapse.nova-staging.svc.cluster.local:8008"
  MATRIX_PUBLIC_URL: "https://matrix.staging.gcp.icered.com"
  MATRIX_SERVER_NAME: "staging.gcp.icered.com"
  MATRIX_SERVICE_USER: "@nova-service:staging.gcp.icered.com"
  MATRIX_DEVICE_NAME: "nova-realtime-chat-service"
  # Matrix-first: do not persist/broadcast Matrix ingress via Nova DB/WebSocket
  MATRIX_FIRST: "true"
  # Kafka for identity event sync
  KAFKA_ENABLED: "true"
  KAFKA_BROKERS: "kafka.nova-staging.svc.cluster.local:9092"
  KAFKA_CONSUMER_GROUP_ID: "realtime-chat-service"
  KAFKA_IDENTITY_EVENTS_TOPIC: "identity-events"
