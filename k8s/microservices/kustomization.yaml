apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# NOTE: Do NOT set namespace here - let overlays handle namespace configuration
# This avoids conflicts when multiple Namespace resources exist

# Include all microservice deployments
resources:
  # Core microservices (14 services)
  - analytics-service-deployment.yaml
  - analytics-service-service.yaml
  - analytics-service-configmap.yaml
  - analytics-service-serviceaccount.yaml
  
  - content-service-deployment.yaml
  
  - feed-service-deployment.yaml
  - feed-service-configmap.yaml
  
  - graph-service-deployment.yaml
  - graph-service-service.yaml
  - graph-service-configmap.yaml
  - graph-service-serviceaccount.yaml

  - graphql-gateway-deployment.yaml
  - graphql-gateway-service.yaml
  - graphql-gateway-configmap.yaml
  - graphql-gateway-serviceaccount.yaml

  - identity-service-deployment.yaml
  - identity-service-service.yaml
  - identity-service-configmap.yaml
  - identity-service-serviceaccount.yaml

  - media-service-deployment.yaml
  - media-service-service.yaml
  - media-service-configmap.yaml

  # messaging-service: DEPRECATED - replaced by realtime-chat-service
  # All messaging functionality (DM + WebSocket + E2EE) is now in realtime-chat-service

  - notification-service-deployment.yaml
  - notification-service-service.yaml
  - notification-service-configmap.yaml
  - notification-service-serviceaccount.yaml
  
  - ranking-service-deployment.yaml
  - ranking-service-service.yaml
  - ranking-service-configmap.yaml
  - ranking-service-serviceaccount.yaml
  
  - realtime-chat-service-deployment.yaml
  - realtime-chat-service-service.yaml
  - realtime-chat-service-configmap.yaml
  - realtime-chat-service-serviceaccount.yaml
  
  - search-service-deployment.yaml
  - search-service-service.yaml
  - search-service-configmap.yaml
  - search-service-serviceaccount.yaml
  
  - social-service-deployment.yaml
  - social-service-service.yaml
  - social-service-configmap.yaml
  - social-service-secret.yaml
  - social-service-serviceaccount.yaml
  
  - trust-safety-service-deployment.yaml
  - trust-safety-service-service.yaml
  - trust-safety-service-configmap.yaml
  - trust-safety-service-serviceaccount.yaml

  - feature-store-deployment.yaml
  - feature-store-service.yaml
  - feature-store-configmap.yaml
  - feature-store-serviceaccount.yaml
  - feature-store-secret.yaml

  - streaming-service-deployment.yaml
  - streaming-service-service.yaml
  - streaming-service-configmap.yaml
  - streaming-service-serviceaccount.yaml
  - streaming-service-secret.yaml

  - alice-voice-service-deployment.yaml
  - alice-voice-service-service.yaml
  - alice-voice-service-configmap.yaml
  - alice-voice-service-serviceaccount.yaml
  - alice-voice-service-secret.yaml
  - alice-voice-nginx-configmap.yaml
  - alice-voice-service-backendconfig.yaml
  - alice-voice-service-ingress.yaml

  # API Gateway: DEPRECATED - now using GKE ELB directly via graphql-gateway
  # api-gateway/deployment.yaml, service.yaml, configmap-nginx.yaml are archived
  # See k8s/microservices/api-gateway/ for reference only

  # NOTE: Ingress for nova-api-gateway is now managed in k8s/infrastructure/base/ingress.yaml
  # to avoid duplicate Ingress definitions across environments.
  # Optional TLS + cert-manager integration (ClusterIssuer etc.)
  # ingress-tls-setup.yaml is disabled by default to avoid requiring cert-manager CRDs in all environments.
  # Apply manually when cert-manager is installed:
  # - ingress-tls-setup.yaml
  # NOTE: prometheus-monitoring-setup.yaml commented out due to namespace conflicts
  # with staging overlay's namespace transformation. Deploy monitoring separately if needed.
  # - prometheus-monitoring-setup.yaml
  - s3-configmap.yaml
  # messaging-service-cronjobs.yaml: DEPRECATED - messaging-service replaced by realtime-chat-service
  - turn-server-deployment.yaml
