apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: nova-db-credentials
  namespace: nova-staging
spec:
  refreshInterval: 15m
  secretStoreRef:
    kind: ClusterSecretStore
    name: aws-secretsmanager
  target:
    name: nova-db-credentials
    creationPolicy: Merge
  dataFrom:
    - extract:
        key: nova/staging/nova-db-credentials
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: nova-jwt-keys
  namespace: nova-staging
spec:
  refreshInterval: 15m
  secretStoreRef:
    kind: ClusterSecretStore
    name: aws-secretsmanager
  target:
    name: nova-jwt-keys
    creationPolicy: Merge
  dataFrom:
    - extract:
        key: nova/staging/nova-jwt-keys
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: nova-clickhouse-credentials
  namespace: nova-staging
spec:
  refreshInterval: 15m
  secretStoreRef:
    kind: ClusterSecretStore
    name: aws-secretsmanager
  target:
    name: nova-clickhouse-credentials
    creationPolicy: Merge
  dataFrom:
    - extract:
        key: nova/staging/nova-clickhouse-credentials
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: nova-s3-credentials
  namespace: nova-staging
spec:
  refreshInterval: 15m
  secretStoreRef:
    kind: ClusterSecretStore
    name: aws-secretsmanager
  target:
    name: nova-s3-credentials
    creationPolicy: Merge
  dataFrom:
    - extract:
        key: nova/staging/nova-s3-config

---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: social-service-secret
  namespace: nova-staging
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: aws-secretsmanager
  target:
    name: social-service-secret
    creationPolicy: Owner
    deletionPolicy: Retain
  dataFrom:
    - extract:
        key: nova/staging/social-service-secret
