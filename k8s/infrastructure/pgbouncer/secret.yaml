##############################################################################
# PgBouncer Secret (TEMPLATE)
# Stores sensitive authentication data
#
# IMPORTANT: This is a TEMPLATE only!
# 
# Do NOT commit the actual userlist.txt with real passwords to Git!
# 
# Instructions for creating the actual Secret:
# 
# 1. Generate passwords:
#    cd backend/infrastructure/pgbouncer
#    PGBOUNCER_NOVA_USER_PASS="..." \
#    PGBOUNCER_ADMIN_PASS="..." \
#    PGBOUNCER_STATS_USER_PASS="..." \
#    ./generate_userlist.sh
# 
# 2. Create Kubernetes Secret from the generated file:
#    kubectl create secret generic pgbouncer-userlist \
#      --from-file=userlist.txt=./userlist.txt \
#      -n nova
# 
# 3. Verify the Secret was created:
#    kubectl get secret pgbouncer-userlist -n nova
#    kubectl describe secret pgbouncer-userlist -n nova
# 
# 4. To view the encoded data:
#    kubectl get secret pgbouncer-userlist -n nova -o jsonpath='{.data.userlist\.txt}' | base64 -d
##############################################################################

apiVersion: v1
kind: Secret
metadata:
  name: pgbouncer-userlist
  namespace: nova
  labels:
    app: pgbouncer
    component: database-proxy

type: Opaque

# Base64-encoded secret data
# DO NOT put real passwords here - generate using the script above
data:
  userlist.txt: |
    ICJub3ZhX3VzZXIiICJTQ1JBTS1TSEEtMjU2JDQwOTYk...
    ICJhZG1pbiIgIlNDUkFNLVNIQS0yNTYkNDA5NiQ...
    ICJzdGF0c191c2VyIiAiU0NSQU0tU0hBLTI1NiQ0MDk2JA==

---

# Alternative: Using stringData (NOT recommended for sensitive data in production)
# This is provided for convenience in development/testing only
apiVersion: v1
kind: Secret
metadata:
  name: pgbouncer-userlist-alt
  namespace: nova
  labels:
    app: pgbouncer
    component: database-proxy

type: Opaque

# IMPORTANT: stringData should NOT be used for actual sensitive data!
# This is shown for illustration/testing purposes only
stringData:
  userlist.txt: |
    ; TEMPLATE - Replace with actual SCRAM-SHA-256 hashes
    "nova_user" "SCRAM-SHA-256$4096$base64salt$base64storedkey$base64serverkey"
    "admin" "SCRAM-SHA-256$4096$base64salt$base64storedkey$base64serverkey"
    "stats_user" "SCRAM-SHA-256$4096$base64salt$base64storedkey$base64serverkey"
