apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# 基础 Kustomize 配置
# 这个文件定义所有环境共用的基础配置
# 环境特定的覆盖由 overlays 目录定义

# 命名空间 - 由 overlay 设置，不在 base 中设置
# 这避免了当多个 Namespace 资源存在时的冲突

# 通用标签
labels:
  - includeSelectors: true
    pairs:
      app.kubernetes.io/name: nova
      app.kubernetes.io/managed-by: argocd

# 通用注解
commonAnnotations:
  description: "Nova Microservices Platform"

# 包含的资源 - 直接引用 microservices kustomization
# (不能直接引用 ../microservices 中的文件 - kustomize 安全限制)
# 必须通过 microservices/kustomization.yaml 来引用所有资源
resources:
  - ../microservices

# 配置管理生成器
configMapGenerator:
  - name: nova-config
    literals:
      - APP_NAME=nova
      - API_VERSION=v1

# 密钥生成（如需要）
# secretGenerator:
#   - name: nova-secrets
#     envs:
#       - secrets.env
